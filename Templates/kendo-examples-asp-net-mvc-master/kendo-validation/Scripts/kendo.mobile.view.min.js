/*
* Kendo UI Complete v2012.3.1114 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
(function(e,t){function i(e,t){e[0]&&t[0]&&e[0]!=t[0]&&e.kendoAnimateTo(t,{effects:"fade"})}function n(t){t.each(function(){o.initWidget(e(this),{},l.roles)})}function r(e){for(var t=e.split("?")[1]||"",i={},n=t.split(/&|=/),r=n.length,o=0;r>o;o+=2)i[n[o]]=n[o+1];return i}var o=window.kendo,a=o.mobile,l=a.ui,s=o.attr,d=o.Class,c=l.Widget,h="init",u="show",f="beforeShow",m="hide",w="z-index",p=o.attrValue,v=o.roleSelector,g=c.extend({init:function(t,i){var n=this;c.fn.init.call(n,t,i),t=n.element,n.params={},n.lastParams={},e.extend(n,i),n._layout(),n._scroller(),n._model()},events:[h,f,u,m],options:{name:"View",title:"",defaultTransition:"",stretch:!1,zoom:!1,model:null},destroy:function(){c.fn.destroy.call(this),this.scroller&&this.scroller.destroy(),o.destroy(this.element)},showStart:function(){var e=this;e.element.css("display",""),e.inited||(e.inited=!0,e.trigger(h,{view:e})),e.layout&&e.layout.attach(e),e._eachWidget(function(t){t.viewShow(e)}),e.trigger(u,{view:e})},hideStart:function(){var e=this;e.layout&&e.layout.detach(e)},hideComplete:function(){var e=this;e.element.hide(),e.trigger(m,{view:e})},updateParams:function(e){var t=this;t.trigger(f,{view:t})||(t.lastParams=t.params,t.params=e,t.trigger(u,{view:t}))},switchWith:function(e,t,i,n){var r=this;r.trigger(f,{view:r})||(r.lastParams=r.params,r.params=i,e?(e.hideStart(),r.showStart(),new y({current:e,next:r,transition:t,defaultTransition:e.options.defaultTransition,complete:n})):(r.showStart(),n()))},parallaxContents:function(e){var t=this,i=t.content;return e.header[0]||(i=i.add(t.header)),e.footer[0]||(i=i.add(t.footer)),i},_scroller:function(){var e=this;e.options.stretch?e.content.addClass("km-stretched-view"):(e.content.kendoMobileScroller({zoom:e.options.zoom}),e.scroller=e.content.data("kendoMobileScroller"),e.scrollerContent=e.scroller.scrollElement)},_model:function(){var e=this,t=e.element,i=e.options.model;"string"==typeof i&&(i=o.getter(i)(window)),e.model=i,t.find(v("popover")).each(function(){o.initWidget(this,{},l.roles)}),i?o.bind(t.children(),i,l,o.ui,o.dataviz.ui):a.init(t.children())},_layout:function(){var e=this,t=v("content"),i=e.element;i.data("kendoView",e).addClass("km-view"),e.transition=p(i,"transition"),e.header=i.children(v("header")).addClass("km-header"),e.footer=i.children(v("footer")).addClass("km-footer"),i.children(t)[0]||i.wrapInner("<div "+s("role")+'="content"></div>'),e.content=i.children(v("content")).addClass("km-content"),e.element.prepend(e.header).append(e.footer),e.id=p(i,"url")||"#"+i.attr("id"),e.layout&&e.layout.setup(e)},_eachWidget:function(t){var i;this.element.find("[data-"+o.ns+"role]").each(function(){i=o.widgetInstance(e(this),l),i&&t(i)})}}),y=d.extend({init:function(t){e.extend(this,t);var n=this,r=n.current,o=n.next,a=r.element,l=o.element,s=o,d=r,c=n._transition();c.reverse&&!c.parallax&&(s=r,d=o),s.element.css(w,1),d.element.css(w,0),c.parallax&&(i(r.footer,o.footer),i(r.header,o.header),a=r.parallaxContents(o),l=o.parallaxContents(r)),a.kendoAnimateTo(l,c),n.back()||(r.nextView=o,r.backTransition=c.transition)},_transition:function(){var e=this,t=e.current,i=e.next,n=e.back(),r=function(){t.hideComplete(),e.complete()},o=n?i.backTransition:i.transition,a=e.transition||o||e.defaultTransition,l=a.split(" "),s=l[0],d=/^slide/.test(s),c="reverse"===l[1];return e.back()&&!e.transition&&(c=!c),{effects:s,reverse:c,parallax:d,complete:r,transition:a}},back:function(){var e=this.next,t=this.current;return e.nextView===t&&JSON.stringify(e.params)===JSON.stringify(e.lastParams)}}),_=c.extend({init:function(e,t){var i=this;c.fn.init.call(i,e,t),e=i.element,i.element=e.detach(),i.header=e.children(v("header")).addClass("km-header"),i.footer=e.children(v("footer")).addClass("km-footer"),i.elements=i.header.add(i.footer),o.mobile.init(i.element.children()),i.trigger(h,{layout:i})},options:{name:"Layout"},events:[h,u,m],setup:function(e){e.header[0]||(e.header=this.header),e.footer[0]||(e.footer=this.footer)},detach:function(e){var t=this;e.header===t.header&&e.element.prepend(t.header.detach().clone(!0)),e.footer===t.footer&&e.element.append(t.footer.detach().clone(!0)),t.trigger(m,{layout:t,view:e})},attach:function(e){var t=this;e.header===t.header&&(t.header.detach(),e.element.children(v("header")).remove(),e.element.prepend(t.header)),e.footer===t.footer&&(t.footer.detach(),e.element.children(v("footer")).remove(),e.element.append(t.footer)),t.trigger(u,{layout:t,view:e})}}),x=o.Observable,b=/<body[^>]*>(([\u000a\u000d\u2028\u2029]|.)*)<\/body>/i,k="loadStart",V="loadComplete",C="showStart",S="viewShow",T=x.extend({init:function(t){var i,r,o=this;if(x.fn.init.call(o),e.extend(o,t),o.sandbox=e("<div />"),r=o.container,i=o._hideViews(r),o.rootView=i.first(),!o.rootView[0])throw Error('Your kendo mobile application element does not contain any direct child elements with data-role="view" attribute set. Make sure that you instantiate the mobile application using the correct container.');o._view=null,o.layouts={},o._setupLayouts(r),n(r.children(v("modalview"))),o.loader&&(o.bind(C,function(){o.loader.transition()}),o.bind(k,function(){o.loader.show()}),o.bind(V,function(){o.loader.hide()}),o.bind(S,function(){o.loader.transitionDone()}))},view:function(){return this._view},showView:function(e,t){var i,n,o=this,a=o.container,l=r(e),d="#"===e.charAt(0),c=!d&&!e.match(/^([\w\-]+)$/),h=e.split("?")[0];e!==o.url&&(o.url=e,o.trigger(C),e?(n=a.children("["+s("url")+"='"+e+"']"),n[0]||c||(n=a.children(d?h:"#"+h))):n=o.rootView,i=n.data("kendoView"),n[0]?(i||(i=o._createView(n)),o._show(i,t,l)):o._loadView(e,function(e){o._show(e,t,l)}))},_createView:function(e){var i,n=this,r=p(e,"layout");return r===t&&(r=n.layout),r&&(r=n.layouts[r]),i={defaultTransition:n.transition,loader:n.loader,container:n.container,layout:r},o.initWidget(e,i,l.roles)},_loadView:function(t,i){var n=this;n._xhr&&n._xhr.abort(),n.trigger(k),n._xhr=e.get(t,function(e){n.trigger(V),i(n._createRemoteView(t,e))},"html").fail(function(e){n.trigger(V),0===e.status&&e.responseText&&i(n._createRemoteView(t,e.responseText))})},_createRemoteView:function(e,t){var i,r,o,a=this,l=a.sandbox,d=a.container;return b.test(t)&&(t=RegExp.$1),l[0].innerHTML=t,d.append(l.children("script, style")),i=a._hideViews(l),o=i.first(),o.hide().attr(s("url"),e),a._setupLayouts(l),r=l.children(v("modalview")),d.append(l.children(v("layout modalview")).add(i)),n(r),a._createView(o)},_show:function(e,t,i){var n=this;n._view!==e?e.switchWith(n._view,t,i,function(){n._view=e,n.trigger(S,{view:e})}):(n._view.updateParams(i),n.trigger(S,{view:e}))},_hideViews:function(e){return e.children(v("view splitview")).hide()},_setupLayouts:function(i){var n=this;i.children(v("layout")).each(function(){var i=e(this),r=p(i,"platform");(r===t||r===a.application.os)&&(n.layouts[i.data("id")]=o.initWidget(i,{},l.roles))})}});o.mobile.ViewEngine=T,l.plugin(g),l.plugin(_)})(window.kendo.jQuery);